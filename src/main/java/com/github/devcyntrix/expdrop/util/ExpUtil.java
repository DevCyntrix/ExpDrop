package com.github.devcyntrix.expdrop.util;

import org.bukkit.entity.Player;

/**
 * <a href="https://www.spigotmc.org/threads/how-to-get-players-exp-points.239171/">Spigot</a>
 */
public final class ExpUtil {

    public static int getExpToLevelUp(int level){
        return level <= 15 ? 2*level+7 : level <= 30 ? 5*level-38 : 9*level-158;
    }

    // Calculate total experience up to a level
    public static int getExpAtLevel(int level){
        if(level <= 16){
            return (int) (Math.pow(level,2) + 6*level);
        } else if(level <= 31){
            return (int) (2.5*Math.pow(level,2) - 40.5*level + 360.0);
        } else {
            return (int) (4.5*Math.pow(level,2) - 162.5*level + 2220.0);
        }
    }

    // Calculate player's current EXP amount
    public static int getPlayerExp(Player player){
        int exp = 0;
        int level = player.getLevel();

        // Get the amount of XP in past levels
        exp += getExpAtLevel(level);

        // Get amount of XP towards next level
        exp += Math.round(getExpToLevelUp(level) * player.getExp());

        return exp;
    }

}
